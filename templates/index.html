<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Member Collection</title>
</head>
<body>
    <h1>Add Member</h1>

    <!-- üü¢ Form with IDs (used in JS to collect values) -->
    <form id="memberForm"> <!-- ‚úÖ added id for JavaScript to hook into -->
        <label>
            Name:
            <input type="text" id="name" required> <!-- ‚úÖ added id -->
        </label><br>
        <label>
            Phone:
            <input type="text" id="phone" required> <!-- ‚úÖ added id -->
        </label><br>
        <label>
            Payment Status:
            <input type="number" id="payment_status" required> <!-- ‚úÖ added id -->
        </label><br>
        <button type="submit">Add Member</button>
    </form>

    <!-- üü¢ Response placeholder -->
    <div id="responseBox" style="margin-top: 20px;"></div> <!-- ‚úÖ added response box -->

    <!-- üü¢ JavaScript that sends JSON to FastAPI -->
    <script>
        // ‚úÖ Added JS code to handle form submit without reloading
        document.getElementById("memberForm").addEventListener("submit", async function(e) {
            e.preventDefault();  // ‚úÖ Prevent form from reloading page

            // ‚úÖ Collect values from input fields
            const name = document.getElementById("name").value;
            const phone = parseInt(document.getElementById("phone").value);
            const payment_status = parseInt(document.getElementById("payment_status").value);

            const responseBox = document.getElementById("responseBox");

            try {
                // ‚úÖ Send JSON via fetch to your FastAPI backend
                const res = await fetch("/members", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ name, phone, payment_status }) // ‚úÖ Send as JSON
                });

                if (!res.ok) {
                    const error = await res.json();
                    responseBox.innerText = "Error: " + JSON.stringify(error); // ‚úÖ Show error
                } else {
                    const data = await res.json();
                    responseBox.innerText = "‚úÖ Member added: " + JSON.stringify(data); // ‚úÖ Show success
                }
            } catch (err) {
                responseBox.innerText = "‚ùå Network or server error."; // ‚úÖ Handle network error
            }
        });
    </script>
</body>
</html>
